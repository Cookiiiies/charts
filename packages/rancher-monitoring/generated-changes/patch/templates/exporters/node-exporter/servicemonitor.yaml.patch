--- charts-original/templates/exporters/node-exporter/servicemonitor.yaml
+++ charts/templates/exporters/node-exporter/servicemonitor.yaml
@@ -1,4 +1,7 @@
-{{- if .Values.nodeExporter.enabled }}
+{{- if (and (not .Values.nodeExporter.enabled) .Values.hardenedNodeExporter.enabled) }}
+{{ required "Cannot set .Values.hardenedNodeExporter.enabled=true when .Values.nodeExporter.enabled=false" "" }}
+{{- end }}
+{{- if (and .Values.nodeExporter.enabled (not .Values.hardenedNodeExporter.enabled)) }}
 apiVersion: monitoring.coreos.com/v1
 kind: ServiceMonitor
 metadata:
@@ -13,11 +16,19 @@
     matchLabels:
       app: prometheus-node-exporter
       release: {{ $.Release.Name }}
+  {{- if (index .Values "prometheus-node-exporter" "namespaceOverride") }}
+  namespaceSelector:
+    matchNames:
+      - {{ index .Values "prometheus-node-exporter" "namespaceOverride" }}
+  {{- end }}
   endpoints:
   - port: metrics
     {{- if .Values.nodeExporter.serviceMonitor.interval }}
     interval: {{ .Values.nodeExporter.serviceMonitor.interval }}
     {{- end }}
+    {{- if .Values.nodeExporter.serviceMonitor.proxyUrl }}
+    proxyUrl: {{ .Values.nodeExporter.serviceMonitor.proxyUrl}}
+    {{- end }}
     {{- if .Values.nodeExporter.serviceMonitor.scrapeTimeout }}
     scrapeTimeout: {{ .Values.nodeExporter.serviceMonitor.scrapeTimeout }}
     {{- end }}
